From 8a642578cd316b45fbf7222845646eb3b9d93178 Mon Sep 17 00:00:00 2001
From: Bastian Bloessl <mail@bastibl.net>
Date: Sat, 8 Jan 2022 19:49:53 +0100
Subject: [PATCH] no outline-atomics

---
 compiler/rustc_codegen_llvm/src/llvm_util.rs | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)

diff --git a/compiler/rustc_codegen_llvm/src/llvm_util.rs b/compiler/rustc_codegen_llvm/src/llvm_util.rs
index c2136f161..af483616c 100644
--- a/compiler/rustc_codegen_llvm/src/llvm_util.rs
+++ b/compiler/rustc_codegen_llvm/src/llvm_util.rs
@@ -416,13 +416,13 @@ pub fn llvm_global_features(sess: &Session) -> Vec<String> {
     // -Ctarget-features
     features.extend(sess.opts.cg.target_feature.split(',').flat_map(&filter));
 
-    // FIXME: Move outline-atomics to target definition when earliest supported LLVM is 12.
-    if get_version() >= (12, 0, 0)
-        && sess.target.llvm_target.contains("aarch64-unknown-linux")
-        && sess.target.llvm_target != "aarch64-unknown-linux-musl"
-    {
-        features.push("+outline-atomics".to_string());
-    }
+    //// FIXME: Move outline-atomics to target definition when earliest supported LLVM is 12.
+    //if get_version() >= (12, 0, 0)
+    //    && sess.target.llvm_target.contains("aarch64-unknown-linux")
+    //    && sess.target.llvm_target != "aarch64-unknown-linux-musl"
+    //{
+    //    features.push("+outline-atomics".to_string());
+    //}
 
     features
 }
-- 
2.30.2

